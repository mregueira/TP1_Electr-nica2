Version 4
SHEET 1 880 1220
WIRE -464 80 -544 80
WIRE -80 80 -464 80
WIRE 112 80 16 80
WIRE 160 80 112 80
WIRE 272 80 240 80
WIRE 528 80 272 80
WIRE 624 80 528 80
WIRE 752 80 624 80
WIRE 112 112 112 80
WIRE 752 112 752 80
WIRE 272 176 272 80
WIRE 528 208 528 80
WIRE 752 208 752 192
WIRE -544 224 -544 80
WIRE -416 224 -544 224
WIRE -272 224 -336 224
WIRE -64 224 -176 224
WIRE -32 224 -32 144
WIRE -32 224 -64 224
WIRE 112 224 112 192
WIRE 112 224 96 224
WIRE 208 224 112 224
WIRE -64 320 -64 224
WIRE 224 320 -64 320
WIRE 272 320 272 272
WIRE 272 320 224 320
WIRE 224 352 224 320
WIRE 528 352 528 288
WIRE -544 384 -544 224
WIRE -544 384 -688 384
WIRE -64 400 -64 320
WIRE -544 416 -544 384
WIRE -464 416 -544 416
WIRE -368 416 -400 416
WIRE -224 416 -224 288
WIRE -224 416 -304 416
WIRE 32 448 0 448
WIRE 224 448 224 416
WIRE 288 448 224 448
WIRE 320 448 288 448
WIRE 336 448 320 448
WIRE 352 448 336 448
WIRE 528 448 528 432
WIRE 528 448 432 448
WIRE -224 464 -224 416
WIRE 288 464 288 448
WIRE 288 464 256 464
WIRE -688 496 -688 384
WIRE 336 496 336 448
WIRE 448 496 336 496
WIRE 528 496 528 448
WIRE -544 512 -544 416
WIRE 256 512 256 464
WIRE 256 512 224 512
WIRE 448 512 448 496
WIRE 32 528 32 448
WIRE 48 528 32 528
WIRE 160 528 128 528
WIRE 240 544 224 544
WIRE -224 576 -224 544
WIRE 448 624 448 592
WIRE -544 640 -544 592
WIRE 240 640 240 544
WIRE 320 640 240 640
WIRE 528 640 528 576
WIRE -64 672 -64 496
WIRE 64 752 -64 752
WIRE 160 752 64 752
WIRE 528 768 528 720
WIRE -64 784 -64 752
WIRE 160 800 160 752
WIRE -64 896 -64 848
WIRE 160 912 160 880
WIRE 160 912 144 912
WIRE 144 944 144 912
WIRE -64 992 -64 960
WIRE 80 992 -64 992
WIRE -64 1008 -64 992
WIRE 144 1072 144 1040
WIRE 320 1072 320 640
WIRE 320 1072 144 1072
WIRE 144 1104 144 1072
WIRE -64 1136 -64 1088
WIRE 144 1200 144 1168
FLAG -544 640 0
FLAG -64 672 0
FLAG 528 768 0
FLAG -224 576 0
FLAG 624 80 VO
FLAG -464 80 VR
FLAG 448 624 0
FLAG 192 496 0
FLAG 192 560 VR
FLAG 16 224 0
FLAG 320 448 x
FLAG -688 576 0
FLAG 752 208 0
FLAG -64 1136 0
FLAG 144 1200 0
FLAG 64 752 VR
SYMBOL npn 0 400 M0
SYMATTR InstName Q1
SYMATTR Value BC547C
SYMBOL npn 208 272 M180
SYMATTR InstName Q4
SYMATTR Value BC337-25
SYMBOL pnp -176 288 M270
SYMATTR InstName Q3
SYMATTR Value BC327-25
SYMBOL res -320 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 220
SYMBOL res 544 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 6.5k
SYMBOL res 544 448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4A
SYMATTR Value {10k*q}
SYMBOL res 544 736 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 5.94k
SYMBOL res 256 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RA
SYMATTR Value 1
SYMBOL res -240 448 R0
SYMATTR InstName R6
SYMATTR Value 2.7k
SYMBOL diode -368 432 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode -464 432 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL voltage -544 496 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 24 44 Left 2
SYMATTR Value 15
SYMATTR InstName VR
SYMBOL npn -80 144 R270
SYMATTR InstName Q2
SYMATTR Value tip112
SYMATTR Prefix X
SYMBOL res 512 480 R0
SYMATTR InstName R4B
SYMATTR Value {10k*(1-q)}
SYMBOL res 96 96 R0
SYMATTR InstName RB
SYMATTR Value 1k
SYMBOL res 112 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RC
SYMATTR Value 12k
SYMBOL voltage 336 448 R270
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 59 59 Left 2
SYMATTR Value AC {u(-prb)}
SYMATTR InstName Vi
SYMBOL current 448 592 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Ii
SYMATTR Value AC {u(prb)}
SYMBOL Opamps\\opamp2 192 592 R180
WINDOW 3 -30 -64 Left 2
SYMATTR Value LMx58_LM2904
SYMATTR InstName U1
SYMBOL res -704 480 R0
SYMATTR InstName R2
SYMATTR Value 10Meg
SYMBOL res 144 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL cap 208 352 R0
SYMATTR InstName C1
SYMATTR Value 470p
SYMBOL zener 160 1168 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value DI_BZT52C2V7
SYMATTR Prefix X
SYMBOL res 144 784 R0
SYMATTR InstName R4
SYMATTR Value 120
SYMBOL res 736 96 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL diode -80 784 R0
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL diode -80 896 R0
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL pnp 80 1040 M180
SYMATTR InstName Q5
SYMATTR Value BC327-25
SYMBOL res -80 992 R0
SYMATTR InstName R9
SYMATTR Value 2.7k
TEXT -824 8 Left 2 !.inc ..\\Libreria\\TIP112.lib
TEXT -824 40 Left 2 !.param q = 0.999
TEXT -824 80 Left 2 ;.tran 0 10 5 0.1
TEXT -840 120 Left 2 !.ac dec 100 0.01 100Meg
TEXT -1152 160 Left 2 !.step param prb list -1 1 ; set prb=0 to turn off probe
TEXT -792 -80 Left 2 !.inc ..\\Libreria\\LMx58_LM2904.lib
TEXT -840 272 Left 2 ;.param prb = 0
TEXT -392 -88 Left 2 ;-1/(1-1/(2*(I(Vi)@1*V(x)@2-V(x)@1*I(Vi)@2)+V(x)@1+I(Vi)@2))
TEXT -800 -32 Left 2 !.inc ..\\Libreria\\1N5223.lib
